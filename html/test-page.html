<!DOCTYPE HTML>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="robots" content="noodp" />
    <meta name="template" content="" />
    <link rel="stylesheet" href="../dist/app.css" type="text/css">
    <link rel="stylesheet" href="../dependencies/typekit.css" type="text/css">
    <link rel="stylesheet" href="../dependencies/dexter/publish.css" type="text/css">
    <title>CaaS Test Page</title>
    <style>
        .container {
            margin-top: 50px;
        }
        .help {
            border-top: solid 1px #666;
            width: 80%;
            margin: 60px auto;
            padding: 30px;
            font-family: Arial, Helvetica, sans-serif;
        }
    </style>
</head>

<body class="page basicpage spectrum spectrum--lightest">
    <div class="container">
        <consonant-card-collection id="output" data-config=""></consonant-card-collection>
    </div>

    <div class="help">
        <p><b>Testing Tips</b></p>
        <p>URLParam State examples:</p>
        <ol>
            <li>Hide filter Panel: <a href="?state=filterPanel.enabled:false"><code>filterPanel.enabled:false</code></a></li>
            <li>Results per Page: <a href="?state=collection.resultsPerPage:3"><code>collection.resultsPerPage:3</code></a></li>
            <li>Show Footer Divider: <a href="?state=collection.showFooterDivider:true"><code>collection.showFooterDivider:true</code></a></li>
            <li>Combined statements: <a href="?state=filterPanel.enabled:false,collection.resultsPerPage:3"><code>filterPanel.enabled:false,collection.resultsPerPage:3</code></a></li>
        </ol>
    </div>

    <script>
        let config = {
            "collection": {
                "mode": "lightest",
                "layout": {
                    "type": "3up",
                    "gutter": "4x",
                    "container": "1200MaxWidth"
                },
                "lazyload": "false",
                "button": {
                    "style": "call\u002Dto\u002Daction"
                },
                "resultsPerPage": 6,
                "endpoint": "../../caas/mock-json/smoke.json",
                "fallbackEndpoint": "",
                "totalCardsToShow": "1000",
                "cardStyle": "1:2",
                "showTotalResults": "true",
                "i18n": {
                    "prettyDateIntervalFormat": "{ddd}, {LLL} {dd} | {timeRange} {timeZone}",
                    "totalResultsText": "{total} results",
                    "title": "CaaS Test Collection",
                    "titleHeadingLevel": "h2",
                    "cardTitleAccessibilityLevel": "6",
                    "onErrorTitle": "Sorry there was a system error.",
                    "onErrorDescription": "Please try reloading the page or try coming back to the page another time.",
                    "lastModified": "Last modified {date} "
                },
                "detailsTextOption": "default",
                "setCardBorders": "true",
                "useOverlayLinks": "false",
                "banner": {
                    "register": {
                        "description": "Sign Up",
                        "url": "#registration"
                    },
                    "upcoming": {
                        "description": "Upcoming"
                    },
                    "live": {
                        "description": "Live"
                    },
                        "onDemand": {
                        "description": "On Demand"
                    }
                },
                "useLightText": "false",
                "disableBanners": "false",
                "reservoir": {
                    "sample": "3",
                    "pool": "10000"
                },
                "ctaAction": "",
                "additionalRequestParams": {}
            },
            "featuredCards": "[]",
            "filterPanel": {
                "enabled": "true",
                "eventFilter": "",
                "type": "left",
                "showEmptyFilters": "true",
                "filters": [{"openedOnLoad":false,"icon":"","id":"caas:cta","items":[{"label":"Read now","id":"caas:cta/read-now"}],"group":"CTA"}],
                "filterLogic": "or",
                "i18n": {
                    "leftPanel": {
                        "header": "Refine Your Results",
                        "clearAllFiltersText": "Clear All",
                        "mobile": {
                            "filtersBtnLabel": "Filters",
                            "panel": {
                                "header": "Filter by",
                                "totalResultsText": "{total} results",
                                "applyBtnText": "Apply",
                                "clearFilterText": "Clear",
                                "doneBtnText": "Done"
                            },
                            "group": {
                                "totalResultsText": "{total} results",
                                "applyBtnText": "Apply",
                                "clearFilterText": "Clear",
                                "doneBtnText": "Done"
                            }
                        }
                    },
                    "topPanel": {
                        "groupLabel": "Filters:",
                        "clearAllFiltersText": "Clear All",
                        "moreFiltersBtnText": "More Filters +",
                        "mobile": {
                            "group": {
                                "totalResultsText": "{total} results",
                                "applyBtnText": "Apply",
                                "clearFilterText": "Clear",
                                "doneBtnText": "Done"
                            }
                        }
                    }
                }
            },
            "hideCtaIds": "[]",
            "sort": {
                "enabled": "true",
                "defaultSort": "titleAsc",
                "options": [{"label":"Featured","sort":"featured"},{"label":"Title: (A - Z)","sort":"titleAsc"},{"label":"Random","sort":"random"},{"label":"Date: (Newest to Oldest)","sort":"dateDesc"}]
            },
            "pagination": {
                "animationStyle": "paged",
                "enabled": "true",
                "resultsQuantityShown": "true",
                "loadMoreButton": {
                    "style": "primary",
                    "useThemeThree": "true"
                },
                "type": "paginator",
                "i18n": {
                    "loadMore": {
                        "btnText": "Load More",
                        "resultsQuantityText": "{start} of {end} displayed"
                    },
                    "paginator": {
                        "resultsQuantityText": "{start} - {end} of {total} results",
                        "prevLabel": "Prev",
                        "nextLabel": "Next"
                    }
                }
            },
            "bookmarks": {
                "showOnCards": "true",
                "leftFilterPanel": {
                    "bookmarkOnlyCollection": "false",
                    "showBookmarksFilter": "true",
                    "selectBookmarksIcon": "",
                    "unselectBookmarksIcon": ""
                },
                "i18n": {
                    "leftFilterPanel": {
                        "filterTitle": "My favorites"
                    },
                    "card": {
                        "saveText": "Save Card",
                        "unsaveText": "Unsave Card"
                    }
                }
            },
            "search": {
                "enabled": "true",
                "searchFields": ["contentArea.title","contentArea.description","contentArea.detailText"],
                "i18n": {
                    "noResultsTitle": "Authored No Results Title",
                    "noResultsDescription": "Authored No Results Description",
                    "leftFilterPanel": {
                        "searchTitle": "Buy now",
                        "searchPlaceholderText": "Search Here"
                    },
                    "topFilterPanel": {
                        "searchPlaceholderText": "Search Here"
                    },
                    "filterInfo": {
                        "searchPlaceholderText": "Search Here"
                    }
                }
            },
            "language": "en",
            "country": "US",
            "analytics": {
                "trackImpressions": "",
                "collectionIdentifier": ""
            },
            "target": {
                "enabled": "",
                "lastViewedSession": ""
            },
            "customCard": ["return `<div>Please author a valid custom card key<\/div>`"]
        };

        const searchParams = new URLSearchParams(location.search);
        const newState = searchParams?.get('state');
        const newProps = newState?.split(",");
        if (newProps) {
            // Creates a newConfig object from the new property
            const newConfig = { ...config };
            newProps.forEach((keys, i) => {
                const [path, value] = keys.split(":")
                const pathArr = path.split(".");
                let nestedObj = newConfig;
                for (let i = 0; i < pathArr.length - 1; i++) {
                    nestedObj = nestedObj[pathArr[i]]; // access the nested object
                }
                nestedObj[pathArr[pathArr.length - 1]] = value;
            });
            config = newConfig;
        }
        document.getElementById('output').setAttribute('data-config', JSON.stringify(config))
    </script>
    <script type="text/javascript" src="../dist/main.source.js"></script>
</body>

<div class="modalContainer parsys"></div>

<script type="text/javascript" src="../dependencies/dexter/head.js"></script>
<script type="text/javascript" src="../dependencies/dexter/publish.js"></script>
</html>
